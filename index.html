<!DOCTYPE html>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="description" content="Snake in JavaScript" />
<html lang="en">
    <async head>
        <title>Snake</title>
        <canvas id="a" width="425" height="780"></canvas>
        <style>
            #b {
                display: table;
                margin: 0 auto;
                font-size: 50px;
                font-family: "Arial";
            }
            #a {
                position: absolute;
                top: 0;
                bottom: 0;
                left: 0;
                right: 0;
                margin: auto;
            }
        </style>
    </head>
    <async body>
        <div>
            <p id="b">1</p>
        </div>
        <script>
            var b=document.getElementById("a").getContext("2d"),c=[],d={x:10,y:10},e=1,f=Date.now();function h(){return{x:Math.floor(20*Math.random()),y:Math.floor(20*Math.random())}}var k=h(),l={x:1,y:0};function m(){for(var a=4;a<c.length;a++)if(c[a].x===c[0].x&&c[a].y===c[0].y)return!0;return!1}
            function q(){b.clearRect(0,0,400,400);b.fillStyle="black";b.fillRect(0,0,400,400);b.fillStyle="limegreen";c.forEach(function(a,g){g/=c.length;b.fillStyle=(-0*g<<16)+(255+-204*g<<8)+(-0*g|0);b.fillRect(20*a.x,20*a.y,20,20)});b.fillStyle="rgb(255, 0, 0)";b.fillRect(20*k.x,20*k.y,20,20)}
            function r(){d={x:d.x+l.x,y:d.y+l.y};["x","y"].forEach(function(a){for(;0>d[a];)d[a]+=20;for(;20<=d[a];)d[a]-=20});c.push(d);if(m())throw alert("You lost!"),Error("Game over.");for(;c.length>e;)c.shift();d.x===k.x&&d.y===k.y&&(e++,document.getElementById("b").innerHTML=e,k=h(),c.forEach(function(a){k.x==a.x&&k.y==a.y&&(k=h())}))}
            document.addEventListener("keydown",function(a){a=a.code;"KeyA"!=a&&"ArrowLeft"!=a||0!==l.x||(l={x:-1,y:0});"KeyS"!=a&&"ArrowDown"!=a||0!==l.y||(l={x:0,y:1});"KeyD"!=a&&"ArrowRight"!=a||0!==l.x||(l={x:1,y:0});"KeyW"!=a&&"ArrowUp"!=a||0!==l.y||(l={x:0,y:-1})});function t(a){var g=1E3/6,n=Date.now(),p=n-f;a.requestAnimationFrame(function(){p>g&&(r(),q(),f=n-p%g);t(a)})}t(window);
        </script>
    </body>
</html>
